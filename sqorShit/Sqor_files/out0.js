(function(c,e,g){c.Settings={env:"production",facebook_app_id:"501811556564436",googleAnalyticsTrackingId:"UA-38230514-4",pingdomId:"52424ebcabe53d0753000000",alexa:"g8Atj1aAkN002q",RESTBaseURL:"",cloudFront:"https://prod-cdn.sqor.com/",S3Videos:"https://s3.amazonaws.com/sqor-videos-output/",websocketsUrl:"wss://prod-websockets.sqor.com/ws?token=",APIVersion:5}})(window.sqor=window.sqor||{},jQuery);var root=this;
(function(c,e,g){c.Util=c.Util||{};var b=c.Util;e(function(){var a=new c.Views.NotificationPopupList;b.addPopup=a.addPopup;b.clearPopups=a.clear});b.updateOrCreateMetaTag=function(a,d){0==e('meta[property="'+a+'"]').attr("content",d).length&&e("meta").last().after('<meta property="'+a+'" content="'+d+'">')};b.getMLBSFormatScore=function(a){if(1>a&&0<a){a="."+String(String(a).split(".")[1]);for(var d=0;d<4-a.length;d++)a+="0"}return String(a)};b.scrollTo=function(a,d){var b=e(".navbar").height()||0;
done=_.exists(d.done)?d.done:e.noop;duration=_.exists(d.duration)?d.duration:400;e("html, body").animate({scrollTop:a.offset().top-b},{duration:400,complete:_.once(done)})};b.clamp=function(a,d,b){return a<d?d:a>b?b:a};b.urlFor=function(a){var d=_.exists(a.name)?a.name.split(" ").join("-"):"";switch(a.type){case "User":return"/users/"+a.id+"/"+d;case "Team":return"/team/"+a.id+"/"+a.league+"/"+d;case "Player":return"/athlete/"+a.id+"/"+d}return"can't find url"};b.loadFullModel=function(a,d){var b;
switch(a.type){case "Player":b=new c.Models.Athlete({id:a.id});break;case "Team":b=new c.Models.Team({id:a.id});break;case "User":b=new c.Models.User({id:a.id});break;default:console.log("can't find model type.");debugger;return}b.fetch({success:function(){d(b)}})};b.countryNameToCountryCode=function(a){a=b.capitalizeFirstLetter(a);"Ivory Coast"==a&&(a="C\u00f4te d'Ivoire");"USA"==a&&(a="United States");"England"==a&&(a="United Kingdom");"Korea Republic"==a&&(a="Korea, Democratic People's Republic of");
return _.chain(country_data).filter(function(d){return-1!=d.name.indexOf(a)}).first().value()["alpha-2"].toLowerCase()};b.publicProfileRoute=function(a){return"/users/"+a};b.capitalizeFirstLetter=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};b.twitterShareUrl=function(a,d){return"https://twitter.com/intent/tweet?text=&url="+encodeURIComponent(a)+"&via=sqor"};b.postPermaUrl=function(a){return window.location.origin+"/posts/"+a};b.badgesUrl=function(){return"/users/"+c.currentUser.id+"/badges"};
b.postLikesPermaUrl=function(a){return"/posts/"+a+"/likes"};b.getTemplateBlocking=function(a,d){var b="";e.ajax({url:"/templates/"+a+".html",async:d||!1,success:function(a){b=a}});return b};b.RotateAndResizeImage=function(a,d){d=_.exists(d)?d:800;return"/rest/images/transform?imageUrl="+a+"&width="+d+"&transform=ScaleFitWidth,RotateExif"};b.hasGetUserMedia=function(){return!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)};b.submitVideo=
function(a){e(".loadingSpinners").show();var d=a.name.split(".").pop(),b="";c.Util.getSignedUrlAmazon("video",d,a.type).done(function(d){e(".loadingSpinners .spinnerTextHolder").text("Uploading Video..");b=d;d=new XMLHttpRequest;d.onload=function(){e(".loadingSpinners .spinnerTextHolder").text("Your post will be ready in about 30 seconds.");var a=e(".post-area").val(),a=c.Util.linkMedia(b,a,"video");a.done(function(){c.Util.refresh()});a.fail(function(a){e(".loadingSpinners .spinnerTextHolder").text("Error uploading your video.")})};
d.open("PUT",b);d.setRequestHeader("Content-Type",a.type);d.send(a)})};b.hasFacebookPermission=function(a){var d=!1;FB.api("/me/permissions",function(b){d=_.has(b.data[0],a)});return d};b.shareToFacebook=function(a,d){FB.ui({method:"share",href:b.postPermaUrl(a.get("id"))},function(a){})};b.shareToFacebookFeed=function(a){b.shareToFacebook(a,"feed")};b.shareToFacebookPage=function(a){FB.api("/me/accounts/"+c.currentUser.facebook_page_id,function(d){b.shareToFacebook(a,"page")})};b.summarizeIt=function(a,
d){if(!_.exists(a)||a.length<=d)return a;var b=a.substr(0,d),c=a.substr(d),e=c.indexOf(" ");return 0<=e?b+c.substr(e,e+1)+"...":b};b.refresh=function(){window.location=window.location};b.inchesToFeet=function(a){return Math.floor(a/12)+"' "+a%12+"''"};b.isValidEmail=function(a){return _.isValidEmail(a)};b.postAthleteForm=function(a,d,b){a=_.extend({},{athlete_sport_id:"0",accepted_service_contract_id:"1"},a);e.ajax({url:"/rest/AthleteVerificationRequest",type:"post",data:JSON.stringify(a),headers:{"Content-Type":"application/json",
"sqor-api-version":c.Settings.APIVersion},contentTYpe:"application/json",success:function(a){console.info(a);d(a)}})};b.athleteNameToImageURL=function(a){a=a.split(" ");var d=a[1];return"/images/home/athletes/"+a[0].toLowerCase()+"_"+d.toLowerCase()+".png"};b.getSignedUrlAmazon=function(a,d,c){a={media_type:a,file_extension:d,content_type:c};a=JSON.stringify(a);return e.ajax({type:"POST",beforeSend:function(a){a.setRequestHeader("access-token",b.getToken());a.setRequestHeader("Content-Type","application/json")},
data:a,url:"/rest/posts/upload",processData:!1})};b.pluralize=function(a,d){return 1==d?a:a+"s"};b.getSports=function(a){e.get("/rest/sports/leagues",a)};b.getAthleteContracts=function(a){e.get("/rest/ServiceContract",a)};b.getHash=function(){return window.location.hash.substr(1)};b.getQueryParam=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))};b.isFeaturedAthlete=
function(a){return _.chain(c.Views.FeaturedAthleteCard.athleteList).pluck("id").contains(a).value()};b.linkMedia=function(a,d,c){a=a.split("?")[0];d={content:d,media:[{type:c,link:a}]};d=JSON.stringify(d);return e.ajax({type:"POST",beforeSend:function(a){a.setRequestHeader("access-token",b.getToken());a.setRequestHeader("Content-Type","application/json")},data:d,url:"/rest/posts",processData:!1})};b.isFollowing=function(a,d){null===c.currentUser?d(!1):(new c.Models.User({id:a})).fetch().done(function(a){d(a.is_following)})};
b.showLogin=function(a,d){var b=e(a).find(".navbar-toggle").is(":visible"),c=e(a).find("#signup-and-login-holder"),f=e(document).find(".navbar-collapse");"undefined"===typeof d&&(d=c.is(":visible")?"hide":"show");c.toggle("show"==d);b&&f.collapse(d);b&&("show"===d||c.is(":visible"))&&setTimeout(function(){f.animate({scrollTop:f.height()},"slow")},250)};b.toggleMenu=function(a){if(e(document).find(".navbar-toggle").is(":visible")){var d=e(document).find(".navbar-collapse");_.exists(a)||(a=d.hasClass("in")?
"hide":"show");d.collapse(a)}};b.followLastViewed=function(a){var d=c.Global.get("last_viewed_id");a||(a=function(){});console.log(d,e.isNumeric(d));d&&e.isNumeric(d)?c.Util.makePostFollowRequest(d,"follow",a):a()};b.makePostFollowRequest=function(a,d,b){e.ajax({url:"/rest/entities/"+a+"/"+d,type:"post",headers:{"sqor-api-version":c.Settings.APIVersion},success:function(a){b&&b()}})};b.isUserAtBottomOfFeed=function(){return window.scrollY>e(document).height()-e(window).height()-500};b.userProfileURL=
function(a){return"/users/"+a};b.isMyOwnProfile=function(a){return null===c.currentUser?!1:c.currentUser.id===a};b.getMonthShortName=function(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a]};b.loadMasonry=function(a,d){d||(d=function(){});var b=e(a).data("masonry-options")||{};e(a).imagesLoaded(function(){e(a).masonry(b);d()})}})(root.sqor=root.sqor||{},jQuery);root=this;(function(c,e,g){c.Global=c.Global||{};c=c.Global;c.items={};c.get=function(b){return this.items[b]||null};c.set=function(b,a){this.items[b]=a;return!0}})(root.sqor=root.sqor||{},jQuery);(function(c,e,g){var b=c.Util||{};b.setCookie=function(a){b.deleteOldCookie();var d=(new Date(a.expiration_date)).toUTCString();document.cookie="user_3="+JSON.stringify(a)+"; path=/; expires="+d+";";e.ajaxSetup({headers:{"sqor-api-version":c.Settings.APIVersion,"access-token":a.access_token}})};b.trackUser=function(a){_.exists(c.Util.ga)&&_.exists(c.Settings.googleAnalyticsTrackingId)&&ga("create",c.Settings.googleAnalyticsTrackingId,{userId:""+a.id})};b.setCookieViaJSON=function(a){b.deleteOldCookie();
var d=(new Date(a.expiration_date)).toUTCString();cleanUser=_.extend({},a,{password:""});document.cookie="user_3="+JSON.stringify(cleanUser)+"; path=/; expires="+d+";";e.ajaxSetup({headers:{"sqor-api-version":c.Settings.APIVersion,"access-token":a.access_token}})};b.UI=b.UI||{};b.UI.showTopRightBubble=function(a,d,b){a=_.extend({},{text:a||"Sample Text",timeOut:4E3},b);var c=e("<div>"+a.text+"</div>");d=_.extend({},{position:"fixed",top:"0px","border-radius":"5px",left:"0px",right:"0px",height:"100px",
"text-align":"center","font-size":"20px",padding:"20px",background:"yellow","z-index":"99999999999999999999999"},d);c.css(d);c.hide();c.fadeIn();e(document.body).append(c);setTimeout(function(){c.fadeOut(function(){c.remove()})},a.timeOut);return c};b.isFacebooker=function(){return _.exists(c.currentUser)?!1:"facebook"===c.currentUser.account_type};b.deleteOldCookie=function(){b.deleteCookie("user_2");b.deleteCookie("c_user");b.deleteCookie("ss_user");b.deleteCookie("user")};b.deleteCookie=function(a){document.cookie=
a+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"};b.getUserCookie=function(){for(var a=document.cookie.split(";"),d=0;d<a.length;d++){var b=a[d].trim();if(0===b.indexOf("user_3="))return b.substring(7,b.length)}return""};b.updateSession=function(a){c.currentUser=_.extend({},c.currentUser,a);b.setCookie(c.currentUser);b.trackUser(c.currentUser)};b.loginFB=function(a,d){FB.login(function(a){_.exists(d)&&d();var e=a.authResponse.grantedScopes,e=_.exists(e)?e.split(","):[];b.updateSession({facebook_permissions:e});
b.didUserGrantPermissions(e,e)&&(new c.Models.OAuth({provider:"Facebook",token:a.authResponse.accessToken})).save()},{scope:a.join(","),return_scopes:!0})};b.OauthFacebook=function(a,d){FB.login(function(a){var e=a.authResponse.grantedScopes,e=_.exists(e)?e.split(","):[];b.updateSession({facebook_permissions:e});b.didUserGrantPermissions(e,e)&&(new c.Models.OAuth({provider:"Facebook",token:a.authResponse.accessToken})).save({},{success:d})},{scope:a.join(","),return_scopes:!0})};b.OauthTwitter=function(a){var b=
"/rest/auth/twitter?user_id="+c.currentUser.user_id+"&return_url="+encodeURIComponent(window.location.origin),e=window.open(b,"Post to Twitter!","height=300,width=400");e.focus();var g=setInterval(function(){e.postMessage("authenticated?","*")},300),f=window.addEventListener("message",function(b){"authenticated!"==b.data&&(window.removeEventListener("message",f),clearInterval(g),a())},!1)};b.didUserGrantPermissions=function(a,b){return _.intersection(a,b).length===b.length};b.isLoggedIn=function(){return _.exists(c.currentUser)};
b.getSession=function(){var a=b.getUserCookie();if(""===a)return null;e.ajaxSetup({headers:{"access-token":JSON.parse(b.getUserCookie()).access_token,"sqor-api-version":c.Settings.APIVersion}});a=JSON.parse(a);!_.exists(a.id)&&_.exists(a.user_id)&&(a.id=a.user_id);return a=_.extend({},{avatar:"",id:"",location:""},a)};b.getToken=function(){try{return JSON.parse(b.getUserCookie()).access_token}catch(a){return""}};b.logout=function(a){b.deleteCookie("user_3");c.currentUser=null;e.ajaxSetup({headers:{"sqor-api-version":c.Settings.APIVersion}})}})(window.sqor=
window.sqor||{},jQuery);(function(c,e,g){c.Settings=c.Settings||{};c.Util=c.Util||{};c.Global=c.Global||{};c.Models=c.Models||{};c.Collections=c.Collections||{};c.Views=c.Views||{};String.prototype.splice=function(a,b,c){return this.slice(0,a)+c+this.slice(a+Math.abs(b))};e.ajaxSetup({headers:{"sqor-api-version":c.Settings.APIVersion}});c.currentUser=c.Util.getSession();_.extend(window,Backbone.Events);e(window).on("scroll",function(){window.trigger("scroll")});e(document).on("click","a:not([data-bypass])",function(a){var b=
e(this).attr("href"),c=this.protocol+"//";b&&b.slice(0,c.length)!==c&&0!==b.indexOf("javascript:")&&(a.preventDefault(),Backbone.history.navigate(b,!0))});c.Settings.googleAnalyticsTrackingId?(function(a,b,c,e,f,g,h){a.GoogleAnalyticsObject=f;a[f]=a[f]||function(){(a[f].q=a[f].q||[]).push(arguments)};a[f].l=1*new Date;g=b.createElement(c);h=b.getElementsByTagName(c)[0];g.async=1;g.src=e;h.parentNode.insertBefore(g,h)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),c.Util.ga=
ga,_.exists(c.currentUser)?ga("create",c.Settings.googleAnalyticsTrackingId,"auto",{userId:c.currentUser.id.toString()}):ga("create",c.Settings.googleAnalyticsTrackingId,"auto"),ga("require","displayfeatures"),window.onerror=function(a,b,c){ga("send","event","javascript_error",b+" line:"+c,a,{nonInteraction:1});return!1},e(document).ajaxError(function(a,b,c,e){ga("send","event","javascript_error",c.type+" "+c.url,b.status+": "+b.statusText,{nonInteraction:1})})):ga=function(){console.info("Tried to send an event to google analytics but no trackingID is set.",
arguments)};_prum=[["id",c.Settings.pingdomId],["mark","firstbyte",(new Date).getTime()]];(function(){var a=document.getElementsByTagName("script")[0],b=document.createElement("script");b.async="async";b.src="//rum-static.pingdom.net/prum.min.js";a.parentNode.insertBefore(b,a)})();_.exists(c.Settings.alexa)&&(_atrk_opts={atrk_acct:c.Settings.alexa,domain:location.host,dynamic:!0},function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://d31qbv1cthcecs.cloudfront.net/atrk.js";
var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}());_.mixin(_.str.exports());var b=Backbone.View.extend;Backbone.View.extend=function(a,c){var e=b.apply(this,arguments);e.__protoProps__=a;return e};Backbone.View.prototype.close=function(){this.closing&&this.closing();this.subViews&&_.each(this.subViews,function(a){a.close()});for(var a in this)this[a]instanceof Backbone.View&&this[a].close();this.unbind();this.$el.empty();this.stopListening()}})(window.sqor=window.sqor||
{},jQuery);
